var e=Object.defineProperty,t=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,s=Object.prototype.propertyIsEnumerable,r=(t,a,s)=>a in t?e(t,a,{enumerable:!0,configurable:!0,writable:!0,value:s}):t[a]=s,o=(e,o)=>{for(var n in o||(o={}))a.call(o,n)&&r(e,n,o[n]);if(t)for(var n of t(o))s.call(o,n)&&r(e,n,o[n]);return e};export function __vite_legacy_guard(){import("data:text/javascript,")}import{d as n,c as i,C as p,R as c,a as l,b as d,e as u,f as m,s as h,g as f,h as T,i as g,m as E}from"./vendor.340fb2e9.js";var y=n({setup:()=>()=>i(p,{locale:{locale:"zhCN"}},{default:()=>[i(c,null,null)]})});const _={accessToken:"",setting:{theme:"night",layout:"list"}};let O;const v={},S=function(e,t){if(!t)return e();if(void 0===O){const e=document.createElement("link").relList;O=e&&e.supports&&e.supports("modulepreload")?"modulepreload":"preload"}return Promise.all(t.map((e=>{if(e in v)return;v[e]=!0;const t=e.endsWith(".css"),a=t?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${e}"]${a}`))return;const s=document.createElement("link");return s.rel=t?"stylesheet":O,t||(s.as="script",s.crossOrigin=""),s.href=e,document.head.appendChild(s),t?new Promise(((e,t)=>{s.addEventListener("load",e),s.addEventListener("error",t)})):void 0}))).then((()=>e()))},k=[{path:"/:path(.*)",name:"home",component:l((()=>S((()=>import("./index.d6a1e6be.js")),["/assets/index.d6a1e6be.js","/assets/index.30ddad6a.css","/assets/vendor.340fb2e9.js","/assets/useSetting.8f38c14a.js"])))},{path:"/@manage",name:"manage",component:l((()=>S((()=>import("./index.a0044568.js")),["/assets/index.a0044568.js","/assets/index.3af99ca3.css","/assets/useSetting.8f38c14a.js","/assets/vendor.340fb2e9.js"])))}];console.log("here");const P=d({history:u(),routes:k});m.defaults.timeout=6e4,m.defaults.baseURL="";const b=m.create();b.interceptors.response.use((e=>e.data),(e=>{if(e.response){switch(e.response.status){case 401:P.push("error/401");case 403:P.push("error/403")}return{status:500}}return j(`服务器错误！错误代码：${e}`),{status:500,msg:""}}));const j=(e,t="error")=>{console.log(e)},w=e=>{if(!1!==e.token){e.headers||(e.headers={});const t=h.get("ACCESS_TOKEN");t&&(e.headers.Authorization=`${t}`)}return"multipart/form-data"==e.headers["Content-Type"]&&(e.data=(e=>{const t=new FormData;for(const a in e)Array.isArray(e[a])?e[a].forEach(((e,s)=>{t.append(`${a}[${s}]`,e)})):t.append(a,e[a]);return t})(e.data)),b.request(e)},C=e=>C[e];["post","get","put","head","delete","patch"].forEach((e=>{C[e]=(t={})=>w(o({method:e,headers:{"Content-Type":"json"==t.type?"application/json":"multipart/form-data"}},t))})),[["siginin","POST /signin"],["book","POST /search"],["list","GET /api/drive/path/:path"],["setting","GET /api/setting",{token:!0}],["exportSetting","GET /api/setting?raw=true",{token:!0}],["saveSetting","POST /api/setting",{token:!0}],["config","GET /api/config"],["clearCache","PUT /api/cache/clear"],["reload","PUT /api/reload"],["file","POST /api/drive/get",{token:!0}],["files","POST /api/drive/list",{token:!0}]].forEach((e=>{C[e[0]]=(...t)=>{let a=e[1];"function"==typeof a&&(a=a(...t));const s=a.split(/\s/),r=s[0]||"GET";let n={};"object"==typeof t[0]&&(n=o({},t[0])),t.forEach(((e,t)=>{n["$"+(t+1)]=e})),a=s.slice(1).join(" "),a=((e,t)=>e.replace(/(?:\:)([\w\$]+)/g,((e,a)=>a in t?t[a]:e)))(a,n);const i=e[2]||{},p={method:r,url:a};return"GET"==p.method?n.qs&&(p.params=n.qs):p.data=t[0]||i.data||{},p.headers=p.headers||{},p.responseType=i.responseType,"formdata"==i.type?p.headers["Content-Type"]="multipart/form-data":p.headers["Content-Type"]="application/json",i.token&&(p.token=!0),w(p)}}));var $=f({state:_,mutations:{SET_TOKEN:(e,t)=>{e.accessToken=t},SET_THEME:(e,t)=>{e.setting.theme=t},SET_LAYOUT:(e,t)=>{e.setting.layout=t}},actions:{signin:({commit:e},t)=>new Promise(((a,s)=>{C.signin(t).then((t=>{const s=t.result;e("SET_TOKEN",s.token),e("SET_NAME",s.user_name),a(t)})).catch((e=>{s(e)}))})),signout:({commit:e})=>new Promise(((t,a)=>{e("SET_TOKEN",""),C.signout(_.accessToken).then(t).catch((()=>{t({})}))}))},modules:{},plugins:[T()]});g(y).use(P).use($).provide("$message",E).mount("#app");export{C as r};
